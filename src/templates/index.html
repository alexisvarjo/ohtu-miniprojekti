{% extends "layout.html" %}

{% block title %}
Citation App
{% endblock %}

{% block body %}

<h1>Library search</h1>

<!-- Search form -->
<form method="get" action="">
  <!-- Material, Keyword, Publication year -->
  <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
      <label for="material_type" style="width: 60px;">Material:</label>
      <select id="material_type" name="material_type">
        <option value="">All</option>
        <option value="article">Article</option>
        <option value="book">Book</option>
        <option value="misc">Misc</option>
      </select>

      <label for="keyword" style="width: 60px;">Keyword:</label>
      <select id="keyword" name="keyword">
        <option value="">All</option>
        <option value="author">Author</option>
        <option value="title">Title</option>
      </select>
      <label for="year" style="width: 30px;">Year:</label>
      <input type="number" id="year" name="year" style="width: 60px;">
    </div>

  <!-- Search -->
  <div style="display: flex; flex-direction: column; align-items: flex-start; gap: 5px; margin-bottom: 15px;">
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
      <label for="search" style="width: 60px;">Search:</label>
      <input type="text" id="search" name="search" placeholder="Enter keyword" style="width: 200px;">
    </div style="margin-bottom= 20px;">
    <button type="submit">Search</button>
  </div>
</form>

<!-- Link for adding a new article -->
<div style="margin-top: 10px;">
  <a href="{{ url_for('add_article') }}">Add article</a>
</div>

<!-- Web bib viewing -->
<div style="margin-top: 10px;">
  <a href="{{ url_for('bib_view') }}">View bib in browser</a>
</div>

<!-- Bib file download -->
<div style="margin-top: 10px;">
  <a href="{{ url_for('bib_file') }}">Download a .bib file</a>
</div>

<!-- Generate random source -->
<div style="margin-top: 10px;">
  <a href="{{ url_for('test_source') }}">Generate a random source (testing)</a>
</div>

<!-- Flash messages -->
<div style="color: darkgreen;">
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <ul>
          {% for message in messages %}
          <li>{{ message }}</li>
          {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}
</div>

<hr>
<!-- Taulukko -->
<table border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      {% for column in columns %}
        <th>{{ column }}</th>
      {% endfor %}
    <!-- Lisättään 2 tyhjää otsikkoa niin, että taulukko on kokonainen -->
    <th>{{ empty }}</th>
    <th>{{ empty }}</th>
    </tr>
  </thead>
  <tbody>
    {% for row in records %}
      <tr>
        {% for column in columns %}
          <!-- Jos ei löydy tietoa, taulukko näyttää tyhjää-->
          {% if row[column] %}
          <td>{{ row[column] }}</td>
          {% else %}
          <td>{{ empty }}</td>
          {% endif %}
        {% endfor %}
        <td><a href="{{ url_for('edit_article', citekey=row['citekey']) }}">Modify</a></td>
        <!-- korjaa url_for myöhemmin oikeaksi, nyt vaan toi että näkyy jotain -->
        <td><a href="{{ url_for('remove_article', citekey=row['citekey']) }}">Remove</a></td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<p>
  <a href="/{{ page - 1 }}">&lt;&lt;</a>
    Page {{ page }}/{{ page_count }}
  <a href="/{{ page + 1 }}">&gt;&gt;</a>
</p>


{% endblock %}
